{% extends "base.html" %}
{% block title %}Home{% endblock%}
{% block content %}
<form method="POST">
    <h3 align="center">欢迎使用我们的短视频实验平台</h3>
    <br/>
    <div class="form-group">
        <label>假设您正在使用自己的手机浏览短视频进行放松。该平台将会根据您选择的视频偏好自动为您推荐符合您兴趣的短视频。您可以自主决定是否观看每一个视频，在此期间您的选择不受任何限制。</label>
        <ul>
          <li>一旦你观看完某一个视频，平台将自动跳转至下一个视频。</li>
          <li>如果你对某些视频不感兴趣，点击 “下一个”按钮跳过即可。</li>
          <li>在观看的过程中，烦请您通过点击“<strong>喜欢</strong>”或“<strong>不喜欢</strong>”按钮对每一个视频进行评价，我们欢迎您在评论区留下您对视频的评价。</li>
          <li>本实验共包括两轮视频类型选择及视频观看环节，在您完成第一轮视频类型选择后将会依据您的视频偏好为您播放20个短视频，每个视频持续约30秒。第二轮视频播放包含6个短视频，每个视频同样持续约30秒。恳请您耐心完成两轮测试。</li>
          <li>在观看完所有视频后，你需要 <strong>复制平台给出的参与码</strong>， 返回到<strong>原本的问卷页面 </strong> 并且 <strong>将参与码粘贴至相应的位置 </strong>，然后<strong>完成问卷中的剩余问题</strong>来结束该研究。</li>
          <li>如果你不小心关闭了这个页面, 请刷新重进。</li>
          <li>在点击“继续”按钮之后,会在新的窗口弹出一个与本页内容相同的说明页面，以便您在实验期间将其作为参考。稍后请您<strong>返回该页面</strong>选择接下来想要观看的视频类型。”</li>
          <!--<li>一旦你观看完某一个视频,可以点击“<strong>下一个</strong>”按钮观看后面的视频。</li>-->
          <!--<li>如果你对某些视频不感兴趣, 点击 “下一个”按钮跳过即可。</li>-->
          <!--<li>在观看的过程中，您可以通过点击“<strong>喜欢</strong>”、“<strong>不喜欢</strong>”、“<strong>收藏</strong>”等按钮对每一个视频进行评价，或者在评论区留下您自己的评语。</li>-->
          <!--<li>在观看完所有视频后，你需要<strong>复制平台给出的参与码</strong>, 返回到<strong>原本的问卷页面</strong>并将参与码<strong>粘贴至相应的位置</strong>, 然后完成问卷中的剩余问题来结束本次调研。</li>-->
          <!--<li>如果你不小心关闭了这个页面, 请刷新重进。</li>-->
          <!--  <li>在点击“继续”按钮之后,会在新的窗口弹出一个说明页面，在实验期间你可以将其作为参考。稍后请<strong>返回该页面</strong>选择您接下来想要观看的视频类型。</li>-->
        </ul>
    </div>
    <br/>
    <button type="submit" class="btn btn-primary" onclick="calTime()" id="cont"> 继续 </button>
    <script>
    var pay_load;
    var xhr = new XMLHttpRequest();
    xhr.open("POST", '/ready');
    xhr.setRequestHeader("Content-Type", "application/json");
    pay_load = {"id": '{{video_id}}', "status" : "pageReady", "time": Date.now(), "page" : "intro"};
    xhr.send(JSON.stringify(pay_load));
    xhr.onreadystatechange = function () {
    if (xhr.readyState == 4) {
        console.log(xhr.status);
        console.log(xhr.responseText);
      }
      };
    </script>
    <script>
    function calTime(){
        document.getElementById("myButton").click();
        var pay_load;
        var xhr = new XMLHttpRequest();
        xhr.open("POST", '/ready');
        xhr.setRequestHeader("Content-Type", "application/json");
        pay_load = {"id": '{{video_id}}', "status" : "end", "time": Date.now(), "page" : "intro"};
        xhr.send(JSON.stringify(pay_load));
        xhr.onreadystatechange = function () {
        if (xhr.readyState == 4) {
            console.log(xhr.status);
            console.log(xhr.responseText);
        }
      };
    }
    </script>
</form>
<button hidden id="myButton" class="btn btn-light btn-outline-primary" >继续</button>

<script>
    document.getElementById("myButton").onclick = function () {
        window.open("/instructions_refer", '_blank');
        calTime.call();
    };
</script>
{% endblock%}