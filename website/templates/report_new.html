{% extends "base.html" %}
{% block title %}Home{% endblock%}
{% block content %}
<head>
    <!-- <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawChart);
        function drawChart() {

            var data = google.visualization.arrayToDataTable([
            ['Answer', 'Percentage'],
            ["{{cat1}}",     {{cat1_time}}], //This static data needs to reflect dynamic data from html table
            ["{{cat2}}",     {{cat2_time}}], //This static data needs to reflect dynamic data from html table
            ["{{cat3}}",  {{cat3_time}}], //This static data needs to reflect dynamic data from html table
            ]);

            var options = {
            title: 'æ—¶é—´å æ¯”'
            };

            var chart = new google.visualization.PieChart(document.getElementById('piechart'));

            chart.draw(data, options);
        }
    </script> -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script type="text/javascript">
        window.onload = function () {
            var cat1 = "{{ cat1 }}";
            var cat2 = "{{ cat2 }}";
            var cat3 = "{{ cat3 }}";
            var cat1_time = {{ cat1_time }};
            var cat2_time = {{ cat2_time }};
            var cat3_time = {{ cat3_time }};
     
            var chart = echarts.init(document.getElementById('piechart'));
     
            var option = {
                title: {
                    text: 'æ—¶é—´å æ¯”',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'item'
                },
                legend: {
                    orient: 'vertical',
                    left: 'right',
                    top: 'center',
                    align: 'left'  // è®©å›¾ä¾‹é è¿‘é¥¼å›¾
                },
                series: [
                    {
                        name: 'æ—¶é—´å æ¯”',
                        type: 'pie',
                        radius: '50%',
                        data: [
                            { value: cat1_time, name: cat1 },
                            { value: cat2_time, name: cat2 },
                            { value: cat3_time, name: cat3 }
                        ],
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                ]
            };
     
            chart.setOption(option);
        };
    </script>
    
</head>
<h3 align="center">æç¤ºä¿¡æ¯</h3>
<form method="POST">
    <div id="reminderSec" hidden>
        <div class="blue-rectangle">
                <p>âš  é£é™©æé†’</p>
        </div>
        <p1><span style="color:red;">!!!</span>ç³»ç»Ÿæ£€æµ‹åˆ°æ‚¨å·²ç»æµè§ˆäº†å¤§é‡åŒè´¨åŒ–çš„è§†é¢‘å†…å®¹ã€‚<br/>
        é•¿æœŸæš´éœ²äºåŒè´¨åŒ–çš„ä¿¡æ¯è¢«è¯å®èƒ½å¤Ÿå¼ºåŒ–äººä»¬çš„è®¤çŸ¥åå·®å’Œæ€ç»´å±€é™ï¼Œç”šè‡³ä¼šå¯¼è‡´æç«¯æ€æƒ³å’Œæç«¯è¡Œä¸ºã€‚<br/>
        ä¸ºäº†é¿å…æ­¤ç±»é£é™©ï¼Œå¹³å°å»ºè®®æ‚¨æ¢ç´¢æ›´å¤šæ ·åŒ–çš„è§†é¢‘å†…å®¹!</p1>
    </div>
    <br/>

    <div class="blue-rectangle" id="viewingTitle" hidden>
                <p>ğŸ“— æ‚¨çš„è§†é¢‘è§‚çœ‹æŠ¥å‘Š</p>
    </div>
    <div class="form-group" id="generalReport" hidden>
        <label>æ‚¨å…±èŠ±è´¹ {{tot_min}} åˆ† {{spe_seconds}} ç§’è§‚çœ‹çŸ­è§†é¢‘, å…¶ä¸­ <b>{{cat1_per}}%</b> çš„æ—¶é—´ç”¨äºè§‚çœ‹ <b>{{cat1}}</b> è§†é¢‘(å…±<strong>10</strong>ä¸ªè§†é¢‘), <b>{{cat2_per}}%</b> ç”¨äº <b>{{cat2}}</b>è§†é¢‘(å…±<strong>6</strong>ä¸ªè§†é¢‘), <b>{{cat3_per}}%</b> ç”¨äº <b>{{cat3}}</b>è§†é¢‘(å…±<strong>4</strong>ä¸ªè§†é¢‘).</label>
        <hr>
        <div id="visChart" style="display: grid;grid-template-columns: 60% 40%;">
           <div id="piechart" style="height: 350px;"></div>
            <div id="tags" style="height: 350px; font-size: 15px;" hidden>
            <p>ä»¥ä¸‹æ˜¯æ‚¨æœ€å¸¸è§‚çœ‹çš„è§†é¢‘çš„ <strong>å…³é”®è¯</strong>ï¼š</p>
            <div style="font-size: 15px;left:100px;">
                <p >âœ¦ <strong>{{w1}}</strong> </p>
                <p>âœ¦ <strong>{{w2}}</strong> </p>
                <p>âœ¦ <strong>{{w3}}</strong> </p>
                <p>âœ¦ <strong>{{w4}}</strong> </p>
                <p>âœ¦ <strong>{{w5}}</strong> </p>
            </div>
            </div>
        </div>
    </div>
    <br/>

    <!--ä¸‹é¢å‡ è¡Œä¸ºä¿®æ”¹-->
    <div id="evidenceSec" hidden>
        <div class="blue-rectangle">
                <p>ğŸ“„ ä¿¡æ¯èŒ§æˆ¿çš„å±å®³-ç”¨æˆ·å®ä¾‹</p>
        </div>
        <p>â€œå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é™ˆèï¼ˆåŒ–åï¼‰ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«æˆ‘é™·å…¥ä¿¡æ¯èŒ§æˆ¿çš„æ•…äº‹ã€‚ä¿¡æ¯èŒ§æˆ¿ä¸æˆ‘ä»¬çš„è·ç¦»è¿œæ¯”æˆ‘ä»¬æƒ³è±¡å¾—è¿‘ã€‚è®¸å¤šäººåƒæˆ‘ä¸€æ ·ï¼Œæ¯å¤©èŠ±è´¹æ•°ä¸ªå°æ—¶åœ¨çŸ­è§†é¢‘å¹³å°ä¸Šï¼Œæ²‰è¿·äºå®Œå…¨ä¾ç…§æˆ‘ä»¬çš„å…´è¶£è€Œå®šåˆ¶çš„ä¸ªæ€§åŒ–å†…å®¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¾ˆéš¾æ„è¯†åˆ°è‡ªèº«å·²ç»é™·å…¥ç®—æ³•æ„å»ºçš„èŒ§æˆ¿ä¹‹ä¸­ã€‚ä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ˜¯ï¼Œæˆ‘çš„æŠ–éŸ³é¡µé¢è¿‡å»ä¸€å¹´å¤šå±•ç¤ºçš„90%ä»¥ä¸Šçš„å†…å®¹éƒ½ä¸æˆ‘å¸¸å¸¸æµè§ˆçš„å†…å®¹ååˆ†ç›¸ä¼¼ã€‚æˆ‘ç›¸ä¿¡è¢«åŒè´¨åŒ–ä¿¡æ¯å›°ä½çš„ä¸æ­¢æˆ‘ä¸€äººï¼Œæˆ‘å‘¨å›´çš„è®¸å¤šæœ‹å‹ä¹Ÿéƒ½æ˜¯åŒæ ·çš„æƒ…å†µã€‚</p>
        <p>åœ¨æ„è¯†åˆ°ä¿¡æ¯èŒ§æˆ¿é£é™©åï¼Œæˆ‘æ·±åˆ»ä½“ä¼šåˆ°äº†ä¿¡æ¯èŒ§æˆ¿å¸¦æ¥çš„ä¸¥é‡åæœã€‚æˆ‘ä»¬ä¸ä»…æµªè´¹äº†å¤§æŠŠçš„æ—¶é—´ï¼ŒåŒæ—¶æˆ‘ä»¬çš„æ€æƒ³ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šåæ¿€ã€‚æ›´ä»¤äººæ‹…å¿§çš„æ˜¯ï¼Œæˆ‘ä»¬ä¼šå¯¹ä¸æˆ‘ä»¬ä¸åŒçš„çœ‹æ³•å¤±å»ç†è§£å’Œäº†è§£çš„è€å¿ƒã€‚è¿™ç§è®¤çŸ¥å±‚é¢çš„éš”ç¦»ä¼šå¼•å‘è¶Šæ¥è¶Šå¼ºçƒˆçš„ç„¦è™‘æ„Ÿå’Œå­¤ç‹¬æ„Ÿã€‚å—å›°äºä¿¡æ¯èŒ§æˆ¿çš„æˆ‘ä»¬å¤±å»äº†ä¸å¤–ç•Œå¯¹è¯çš„æœºä¼šã€‚æ„è¯†åˆ°ä¿¡æ¯èŒ§æˆ¿é£é™©æ˜¯æä¸ºå…³é”®çš„ä¸€æ­¥ã€‚æˆ‘å·²ç»å¼€å§‹ç€æ‰‹åº”å¯¹ä¿¡æ¯èŒ§æˆ¿ï¼Œæˆ‘ç›¸ä¿¡å‡è¡¡åŒ–å’Œå¤šæ ·åŒ–çš„ä¿¡æ¯æ‘„å…¥åœ¨ä¿¡æ¯ç¤¾ä¼šæ˜¯æä¸ºé‡è¦çš„ï¼â€</p>
    </div>
    <br/>


    <div class="blue-rectangle">
                <p>ä¸‹ä¸€æ­¥</p>
    </div>
    <div id="nextBtn">
        <div id="nextTxt">
        <label style="width: 40%;">æµè§ˆä»¥ä¸Šæç¤ºä¿¡æ¯å¹¶ç‚¹å‡»â€œç»§ç»­â€æŒ‰é’®è¿›è¡Œä¸‹ä¸€æ­¥!</label>
        <span style="font-size: 30px;">â˜ </span><button type="submit" class="btn btn-primary" onclick="calTime()" id="cont">ç»§ç»­</button>
        </div>
    </div>
    <script>
        if ('{{report_type}}' == "r1") {
            document.getElementById("reminderSec").removeAttribute("hidden");
        }
        else if ('{{report_type}}' == "r3") {
            document.getElementById("reminderSec").removeAttribute("hidden");
            document.getElementById("viewingTitle").removeAttribute("hidden");
            document.getElementById("generalReport").removeAttribute("hidden");
        }
        else if ('{{report_type}}' == "r4") {
            // ä¸‹ä¸€è¡Œä¸ºä¿®æ”¹
            document.getElementById("reminderSec").removeAttribute("hidden");
            // document.getElementById("viewingTitle").removeAttribute("hidden");
            // document.getElementById("generalReport").removeAttribute("hidden");
            // ä¸‹ä¸€è¡Œä¸ºä¿®æ”¹
            document.getElementById("evidenceSec").removeAttribute("hidden");
        }
        else if ('{{report_type}}' == "r5") {
            document.getElementById("reminderSec").removeAttribute("hidden");
            document.getElementById("viewingTitle").removeAttribute("hidden");
            document.getElementById("generalReport").removeAttribute("hidden");
            document.getElementById("tags").removeAttribute("hidden");
        }
        else if ('{{report_type}}' == "r6") {
            document.getElementById("viewingTitle").removeAttribute("hidden");
            document.getElementById("generalReport").removeAttribute("hidden");
            document.getElementById("tags").removeAttribute("hidden");
        }
        </script>
    <script>
    var pay_load;
    var xhr = new XMLHttpRequest();
    xhr.open("POST", '/ready');
    xhr.setRequestHeader("Content-Type", "application/json");
    pay_load = {"id": '{{video_id}}', "status" : "pageReady", "time": Date.now(), "page" : "report"};
    xhr.send(JSON.stringify(pay_load));
    xhr.onreadystatechange = function () {
    if (xhr.readyState == 4) {
        console.log(xhr.status);
        console.log(xhr.responseText);
      }
      };
    </script>
    <script>
        function calTime(){
    var pay_load;
    var xhr = new XMLHttpRequest();
    xhr.open("POST", '/ready');
    xhr.setRequestHeader("Content-Type", "application/json");
    pay_load = {"id": '{{video_id}}', "status" : "end", "time": Date.now(), "page" : "report"};
    xhr.send(JSON.stringify(pay_load));
    xhr.onreadystatechange = function () {
    if (xhr.readyState == 4) {
        console.log(xhr.status);
        console.log(xhr.responseText);
      }
      };
    }
    </script>
</form>
{% endblock%}